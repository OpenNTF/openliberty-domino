<?xml version="1.0" encoding="UTF-8"?>
<agent hide="web v3" name="Edit Configuration" publicaccess="false" xmlns="http://www.lotus.com/dxl">
  <trigger type="actionsmenu"/>
  <documentset type="runonce"/>
  <code event="options">
    <lotusscript>Option Public
Option Declare


</lotusscript>
  </code>
  <code event="initialize">
    <lotusscript>Sub Initialize
	On Error GoTo errorHandler
	
	Dim session As New NotesSession, db As NotesDatabase
	Set db = session.CurrentDatabase
	
	Dim configView As NotesView
	Set configView = db.GetView("Configuration")
	Call configView.Refresh
	
	Dim configDoc As NotesDocument
	Set configDoc = configView.Getfirstdocument()
	If configDoc Is Nothing Then
		Set configDoc = db.CreateDocument
		configDoc.Form = "Configuration"
		Call configDoc.Computewithform(False, False)
		Call configDoc.Save(True, False)
	End If
	
	Dim ws As New NotesUIWorkspace
	Call ws.EditDocument(True, configDoc, False, , False, False)
	
	Exit Sub
errorHandler:
	MsgBox Erl &amp; ": " &amp; Error
	End
End Sub</lotusscript>
  </code>
</agent>
